---

- name: Create VMs
  include_tasks: create_vm.yml
  vars:
    vm_name: "{{ item.key }}"
    vm_id: "{{ proxmox_vm_starting_vmid + index }}"
    vm_network: "{{ item.value.network | default(proxmox_network) }}"
    vm_template: "{{ item.value.template }}"
    vm_storage: "{{ item.value.storage | default(proxmox_storage) }}"
    vm_groups: "{{ item.value.groups }}"
    cpu_count: "{{ item.value.cpu_count | default(vm_cpu_count) }}"
    memory_size: "{{ item.value.memory_size | default(vm_memory_size) }}"
    vm_disks: "{{ item.value.disks | default({}) }}"

  loop: "{{ vm_scenarios[vm_scenario] | dict2items }}"
  loop_control:
    index_var: index



# - vm_name
# - vm_id
# - vm_network
# - vm_template
# - vm_storage
# - vm_groups
# - vm_disks
# - vm_cpu_count
# - vm_memory_size

